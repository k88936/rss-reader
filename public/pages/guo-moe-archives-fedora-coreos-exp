<div id="notion-article" class="mx-auto overflow-hidden "><main class="notion light-mode notion-page notion-block-c3be0cc63eb144868504fa47d055df02"><div class="notion-viewport"></div><div class="notion-collection-page-properties"></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-112190d7522b4fae9f08d685810d212e" data-id="112190d7522b4fae9f08d685810d212e"><span><div id="112190d7522b4fae9f08d685810d212e" class="notion-header-anchor"></div><a class="notion-hash-link" href="#112190d7522b4fae9f08d685810d212e" title="学习时间"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">学习时间</span></span></h2><div class="notion-text notion-block-e001ab7515eb476997622d622aa57abb">Jul 1, 2023<!-- --> - </div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-3741f0df5d784cb6af2d6da60472e8b7" data-id="3741f0df5d784cb6af2d6da60472e8b7"><span><div id="3741f0df5d784cb6af2d6da60472e8b7" class="notion-header-anchor"></div><a class="notion-hash-link" href="#3741f0df5d784cb6af2d6da60472e8b7" title="学习计划"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">学习计划</span></span></h2><ul class="notion-list notion-list-disc notion-block-a6215e6bb27c4723a695c3fda839f966"><li>Jul 1, 2023<!-- -->：完成 Fedora CoreOS 的安装与部署</li></ul><ul class="notion-list notion-list-disc notion-block-1df730901c08486eb6a111527895f2d1"><li>Jul 4, 2023<!-- -->：尝试使用 Fedora CoreOS 上的各种容器</li></ul><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-fa40ba2ef3914b488eb960c227a3b5eb" data-id="fa40ba2ef3914b488eb960c227a3b5eb"><span><div id="fa40ba2ef3914b488eb960c227a3b5eb" class="notion-header-anchor"></div><a class="notion-hash-link" href="#fa40ba2ef3914b488eb960c227a3b5eb" title="学习内容"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">学习内容</span></span></h2><ul class="notion-list notion-list-disc notion-block-9b5e0d85119d4647a2ea543755eeed92"><li>了解什么是 Fedora CoreOS</li></ul><ul class="notion-list notion-list-disc notion-block-0a557988f25d4996a5d119c6e5757e20"><li>了解怎么编写 Fedora CoreOS Configuration(FCC)</li><ul class="notion-list notion-list-disc notion-block-0a557988f25d4996a5d119c6e5757e20"><li>了解 Butane 用法</li><li>怎么导入 VMWare 机器</li><ul class="notion-list notion-list-disc notion-block-3e6c9f336ef4474ebb4cf124a437b128"><li>怎么修改导入后的配置文件</li><ul class="notion-list notion-list-disc notion-block-106b7c7fae3b4b3a84970c6875e94e0a"><div class="notion-text notion-block-7f90592ba9644044ae263f75763ce025">（无法直接修改，在首次启动后就会固定下来）</div><li>通过远程修改配置文件（已完成）</li><li>使用QEMU（也做不到，因为Ignotion仅首次启动有效）</li></ul></ul><li>怎么安装软件</li><ul class="notion-list notion-list-disc notion-block-2ca62f08e46e4f44846c1c40e9a4c899"><li>rpm-ostree</li><ul class="notion-list notion-list-disc notion-block-e7a7399c19424051bed3b7ea2cb4f83e"><li>怎么搜索</li></ul></ul></ul></ul><ul class="notion-list notion-list-disc notion-block-c830b09dccad4176b4bef5ddd1ca1caa"><li>Fedora CoreOS 系统内的容器</li><ul class="notion-list notion-list-disc notion-block-c830b09dccad4176b4bef5ddd1ca1caa"><li>Docker</li><li>Podman </li><li>Podman</li></ul></ul><ul class="notion-list notion-list-disc notion-block-cd30d720f68448fe851f34fb42fdfb49"><li>了解 CoreOS 的原理</li></ul><ul class="notion-list notion-list-disc notion-block-2e651fe482a646a99046f0fe5269fd07"><li>了解怎么跨架构使用 CoreOS</li></ul><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-2af623d57d794ff9b7e73432a7a5ed16" data-id="2af623d57d794ff9b7e73432a7a5ed16"><span><div id="2af623d57d794ff9b7e73432a7a5ed16" class="notion-header-anchor"></div><a class="notion-hash-link" href="#2af623d57d794ff9b7e73432a7a5ed16" title="什么是 Fedora CoreOS(FCOS)"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">什么是 Fedora CoreOS(FCOS)</span></span></h2><div class="notion-text notion-block-8a6009dbe5ff4338b1eb6d3de80602a5">一个自动更新的、最小的、整体的、以容器为中心的操作系统</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-d13aac8efe4141cab5641d879e31f7e5" data-id="d13aac8efe4141cab5641d879e31f7e5"><span><div id="d13aac8efe4141cab5641d879e31f7e5" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d13aac8efe4141cab5641d879e31f7e5" title="对FCOS的初印象"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">对FCOS的初印象</span></span></h2><div class="notion-text notion-block-2cb4ca0499ee4665ad0e0bb87d2d92b0">有点像NixOS，都是以配置文件来配置系统。但是FCOS的Ignotion仅在首次启动的时候有效，而NixOS可以随时修改并生成。以至于我在折腾VMWare的时候，写了一个脚本连续导了几次ovf，每次都要重复修改并重新导入，十分麻烦。目前的临时解决方法是，通过远程下载ignotion，然后在首次启动前打快照，以后修改就直接修改远程Ignotion的内容并重启就可以实现重新部署了。看起来像是为了最小化跑起来Linux的产物，所以就要求去除多余的依赖包，仅通过配置文件配置自己必须的软件包和配置来实现初次配置。</div><div class="notion-text notion-block-28f195b88c7d4d3f8930f520838db23b">发现一个很神奇的容器环境 Fedora Toolbox，查询后得知是基于Podman的，而且直接使用宿主机的用户，应该是自动做好了宿主机环境和容器环境的文件映射，似乎是为了让用户能够安装更多的环境在容器里，避免装在主机上而生的？在外边是没有dnf可以用的，只能用 rpm-ostree，安装完还要重启，似乎会进行一次类似镜像一样的打包。但是toolbox里面可以使用dnf，所以应该尽可能避免对宿主机进行更改。那么宿主机应该跑些啥呢？就是一个容器运行系统让大家尽可能运行容器(Run everything in container)？这么一想其实还挺帅的（</div><div class="notion-text notion-block-3c7e7e86056f4144b39d2d7e6675408e">疑问在于，因为CoreOS仅在首次启动时运行Ignotion，那么后续进行软件包依赖的修改必须要重新Deploy一次新的主机？还是说部署CoreOS的情况下，目的就是只初始化一次以后我就不回去动它了？</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-39e0585293a5434b9cf8f2ae83dde8a3" data-id="39e0585293a5434b9cf8f2ae83dde8a3"><span><div id="39e0585293a5434b9cf8f2ae83dde8a3" class="notion-header-anchor"></div><a class="notion-hash-link" href="#39e0585293a5434b9cf8f2ae83dde8a3" title="安装与启动"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">安装与启动</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-e928bbff057e4fd486828e510549800f" data-id="e928bbff057e4fd486828e510549800f"><span><div id="e928bbff057e4fd486828e510549800f" class="notion-header-anchor"></div><a class="notion-hash-link" href="#e928bbff057e4fd486828e510549800f" title="生成ign配置文件"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">生成ign配置文件</span></span></h3><div class="notion-text notion-block-4a5464eb83f443bb861f44ce625c237e">为了方便修改配置，这里使用 VMWare 来进行导入。</div><div class="notion-text notion-block-7ea4ce82c83a4c99814d4c629702ecdc">在 <a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://fedoraproject.org/coreos/download/">Fedora CoreOS | The Fedora Project</a> 下载 Fedora CoreOS，选择 VMWare 镜像下载。</div><div class="notion-text notion-block-f1c4fdfedfbe43e1b8a7043e35ce3036">下载的同时，我们可以准备一下ign配置文件。我们仅仅是为了尝试一下，所以可以先开一个简单的带root权限的用户试试。先在一台有mkpasswd命令的电脑上跑一下，然后输入密码生成一个password_hash，像这样</div><div class="notion-text notion-block-8eca2af37d2d481cacfa8ee64a7ec8bf">生成完密码后，准备ssh公钥，我们就可以编写配置文件了。</div><div class="notion-text notion-block-c89e58c2b98641edb62ad88e8a9daa88">当然，为了方便实验和回滚，我这里选择使用远程的配置文件。所以我还需要另外写一个配置文件用于导入到VMWare，以及方便的快照回滚来重新部署ign，避免重复地导入ovf。</div><div class="notion-text notion-block-ebdce8bcce5b4a3d9be4f1894da93d44">编写好两份 Fedora CoreOS Configuration(以下简称FCC) 配置文件后，我们可以使用 <code class="notion-inline-code">butane</code> 来生成ign文件。这里官方推荐你用 podman，我是无所谓啦~</div><div class="notion-text notion-block-f2d0a9bb43ef42f29b52949971f621e9">在 Windows 上可以用 scoop install butane 安装，然后我们先运行</div><div class="notion-text notion-block-f9bdd94b16c540f49d8e7a171cb7e15b"><code class="notion-inline-code">butane.exe --pretty C:\Users\Guoguo\Documents\VMs\Fedora\remote.fcc &gt; remote.ign</code></div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-bd55aa68cc3648889dd521780a60620a" data-id="bd55aa68cc3648889dd521780a60620a"><span><div id="bd55aa68cc3648889dd521780a60620a" class="notion-header-anchor"></div><a class="notion-hash-link" href="#bd55aa68cc3648889dd521780a60620a" title="导入到 VMWare"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">导入到 VMWare</span></span></h3><div class="notion-text notion-block-8247a33c9b8f4436a6b42a9d2f352fbe">就会生成一个json啦~为了方便放入脚本中，可以先将ign文件进行一次base64编码，然后编写一个 import.ps1</div><div class="notion-text notion-block-cab0c99c5b604cdaa244bef3cd3be061">注意这里ovftool的程序由于路径中有空格，所以要在前面加个 &amp;，再替换FCOS_OVA变量为刚刚下好的ova文件路径，以及修改 $CONFIG_ENCODED 为刚刚编码完成的ign文件，修改一下想要存储的目标路径，就可以等待导入了。</div><div class="notion-text notion-block-d76ef1919ed74313a748f4bc9013e2b9">再运行一次 <code class="notion-inline-code">butane.exe --pretty C:\Users\Guoguo\Documents\VMs\Fedora\example.fcc &gt; example.ign</code> ，将生成的文件放到我服务器网站目录 /var/www/html/playground 上，然后尝试访问，正确返回即可。</div><div class="notion-text notion-block-404d63dd56d24c1381749d1c34920a70">这时，C:\Users\Guoguo\Documents\VMs\Fedora\CoreOS\Fedora CoreOS 目录会生成两个文件，一个是 Fedora CoreOS.vmx，另一个是 Fedora CoreOS-disk1.vmdk，双击.vmx文件导入到VMWare。</div><div class="notion-text notion-block-a5e0769f83824222baf9a0644ed9f7bc">不急着启动，先打个快照以便修改配置文件后回滚，然后就<div class="notion-text-children"><div class="notion-text notion-block-c1a2d83309944f249bce072af38dbe5b">Fedora CoreOS，启动！</div></div></div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-ccfdb712dc2947fe8a63f700e67e26da" data-id="ccfdb712dc2947fe8a63f700e67e26da"><span><div id="ccfdb712dc2947fe8a63f700e67e26da" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ccfdb712dc2947fe8a63f700e67e26da" title="Fedora CoreOS，启动！"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Fedora CoreOS，启动！</span></span></h3><div class="notion-text notion-block-c29174900ebb48d6b7ae2f17e0524266">伴随着一顿跑码，Fedora CoreOS 的第一次就这样被设置完成了，已经是 example.ign 的形状了，你也可以连接上去看看了。</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-5cfb06603c1445638fa2d12e147fb546"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F91b86036-2d29-4f86-83eb-74a3f996917d%2FUntitled.png?table=block&amp;id=5cfb0660-3c14-4563-8fa2-d12e147fb546&amp;t=5cfb0660-3c14-4563-8fa2-d12e147fb546&amp;width=1643&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-8b08f7ed9bf044a593c4b3f56c3c0f41" data-id="8b08f7ed9bf044a593c4b3f56c3c0f41"><span><div id="8b08f7ed9bf044a593c4b3f56c3c0f41" class="notion-header-anchor"></div><a class="notion-hash-link" href="#8b08f7ed9bf044a593c4b3f56c3c0f41" title="后续配置"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">后续配置</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-7ff9e9d552f246688d8da78bdd2788c3" data-id="7ff9e9d552f246688d8da78bdd2788c3"><span><div id="7ff9e9d552f246688d8da78bdd2788c3" class="notion-header-anchor"></div><a class="notion-hash-link" href="#7ff9e9d552f246688d8da78bdd2788c3" title="连接到 Fedora CoreOS"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">连接到 Fedora CoreOS</span></span></h3><div class="notion-text notion-block-cd254793ec9f4e09ba33e68a6b899f65">伴随着启动成功后，身体一阵哆嗦，突然变得索然有味。</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-5cb93cef063e4d55b5506ce83b4e8329"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd938349c-572e-491c-bbac-e6eb04448da6%2FUntitled.png?table=block&amp;id=5cb93cef-063e-4d55-b550-6ce83b4e8329&amp;t=5cb93cef-063e-4d55-b550-6ce83b4e8329&amp;width=1164&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-8f268b6fd25f4fb9ad84d95cc591077e">然后进去一看，欸怎么连dnf都跑不了啊？这怎么装软件？</div><div class="notion-text notion-block-7d240def744940fb9e804622e11ca261">这就不得不提到全容器系统的含金量了。虽然我没有dnf，但是我有 docker，有podman，有toolbox，还有什么是我做不到的吗？</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-0759c12fa02e45528257aee383d2dff4" data-id="0759c12fa02e45528257aee383d2dff4"><span><div id="0759c12fa02e45528257aee383d2dff4" class="notion-header-anchor"></div><a class="notion-hash-link" href="#0759c12fa02e45528257aee383d2dff4" title="安装软件"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">安装软件</span></span></h3><div class="notion-text notion-block-ea776f79e8714b1aa63f10f8fba0904f">在这个系统里没有方便的 dnf 和 rpm，有一个 rpm-ostree，但是一般不建议用这个来安装一些类似 PHP/Python 这样的软件，具体可以参照 Mogeko’s Blog 在 <a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mogeko.me/posts/zh-cn/103">https://mogeko.me/posts/zh-cn/103</a> 中的描述</div><blockquote class="notion-quote notion-block-372e123cf3644082bcc5ce07c96ed2fd"><div>其实，Fedora CoreOS 中存在类似于「表」、「里」两套系统，「表」系统，及运行中的、只读的那套系统；而「里」系统就是「表」系统的镜像。所谓升级 (安装软件) 就是把新的软件安装在「里」系统中，然后再在重启的过程中将「里」系统挂载为「表」系统。没错，在 CoreOS 中升级 (安装) 了新软件后，需要重启才能生效</div></blockquote><div class="notion-text notion-block-1d3e7797f6e948a092cbd11ef6c6ee83">换句话说，我们一般不在 Fedora CoreOS 上直接安装生产环境的软件，而是在容器中进行部署。所以，就发现了一个神奇的东西：Fedora Toolbox~</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-35e14ee7131f407ab83c48f55cdc54d9" data-id="35e14ee7131f407ab83c48f55cdc54d9"><span><div id="35e14ee7131f407ab83c48f55cdc54d9" class="notion-header-anchor"></div><a class="notion-hash-link" href="#35e14ee7131f407ab83c48f55cdc54d9" title="使用 Fedora Toolbox"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">使用 Fedora Toolbox</span></span></h3><div class="notion-text notion-block-a2f9ba544fd74c4c9940c55d65214727">它本来就不是想让你在上面直接运行程序的，作为一个极简的系统，它希望你通过容器来跑服务，使它所有的东西都不会脏到系统。不错，我喜欢！</div><div class="notion-text notion-block-aea4c12d5d3d45f18663974332aec8b2">使用 toolbox create 可以创建一个toolbox container，然后再 toolbox enter 就可以进入到神奇的toolbox里了。当然，toolbox enter 后面也可以跟label，这样就可以创建多个toolbox container。</div><div class="notion-text notion-block-46b7130b7caa42d0a63d5f8fcb672390">这个toolbox container是基于podman的，不过使用起来其实自我感觉还挺不错，更重要的是可以允许你使用dnf来装一些软件和依赖了！于是你就可以在这个自己的小天地里面尽情地玩耍。</div><div class="notion-text notion-block-cd2e1952dcf5481a8b5df2c0bfbcd299">当然，你也可以在这个自己尝试编的neofetch RPM包下安装后尝试跑一编neofetch</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-792c0adebe3e4258a0f19b63e58669a3"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F5cb94d81-395f-468a-85ef-bf6e4165652d%2FUntitled.png?table=block&amp;id=792c0ade-be3e-4258-a0f1-9b63e58669a3&amp;t=792c0ade-be3e-4258-a0f1-9b63e58669a3&amp;width=1787&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-453dafe52e664dcd9662ee3f667ab8fa"><s>不觉得这很酷吗，作为…（被打死）</s></div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-1dc47e856a714b44890b2ed43b6a24f6" data-id="1dc47e856a714b44890b2ed43b6a24f6"><span><div id="1dc47e856a714b44890b2ed43b6a24f6" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1dc47e856a714b44890b2ed43b6a24f6" title="玩耍"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">玩耍</span></span></h2><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-26a5e026a4914bbc9e5d6341efd2b816" data-id="26a5e026a4914bbc9e5d6341efd2b816"><span><div id="26a5e026a4914bbc9e5d6341efd2b816" class="notion-header-anchor"></div><a class="notion-hash-link" href="#26a5e026a4914bbc9e5d6341efd2b816" title="不如试试 rm -rf /* ?"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">不如试试 rm -rf /* ?</span></span></h3><div class="notion-text notion-block-a3b771bf1a9546559d1ac42a6a5db0f7">听说 Fedora CoreOS 十分安全，来试试火之高兴 rm -rf /?</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-0ecf03109fbb407b88cde115a943e28d"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd94f4424-80ef-426b-9dfa-3345557fc531%2FUntitled.png?table=block&amp;id=0ecf0310-9fbb-407b-88cd-e115a943e28d&amp;t=0ecf0310-9fbb-407b-88cd-e115a943e28d&amp;width=1527&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-47f32297912046bc8f0b1289981cc7b8">似乎 /etc/passwd 没了，也没法重启，尝试强制重启后开机？</div><div class="notion-text notion-block-e1b3bc2bb622405d928ac9313eceeb82">然后登陆不进去了……</div><div class="notion-text notion-block-10e2f3e30e7a449da3e2559423727c61">但是！在之前使用 rpm-ostree 进行了一次安装尝试，导致系统打了一次系统镜像备份，于是抱着死马当活马医的心态尝试切换了一下引导，神奇的事情发生了~</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-3f5240d766e54bd7ac16a33fcc418e7d"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbba899d4-cab4-46cd-bdd8-194c2957caab%2FUntitled.png?table=block&amp;id=3f5240d7-66e5-4bd7-ac16-a33fcc418e7d&amp;t=3f5240d7-66e5-4bd7-ac16-a33fcc418e7d&amp;width=1280&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><div class="notion-text notion-block-4801a41b5675405d9ee8a83131ec1354">卧槽，活了，也能正常登录，猜测是系统镜像备份的时候将 /etc 也给镜像进去了，但是家目录是真没了，倒无所谓，可以重建，只能说很强大.jpg</div><h3 class="notion-h notion-h2 notion-h-indent-1 notion-block-6851b113a43941748eb276019370e8dc" data-id="6851b113a43941748eb276019370e8dc"><span><div id="6851b113a43941748eb276019370e8dc" class="notion-header-anchor"></div><a class="notion-hash-link" href="#6851b113a43941748eb276019370e8dc" title="安装可进行rpm编包的程序"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">安装可进行rpm编包的程序</span></span></h3><div class="notion-text notion-block-7547bba0f25340f3bdc36577c09d5376">在 Toolbox 内执行 </div><div class="notion-text notion-block-d9351a69f60e487593333f7dc2fc5ec5"><code class="notion-inline-code">sudo dnf groupinstall &#x27;Development Tools&#x27;</code></div><div class="notion-blank notion-block-91c7a61037394330b6378b93ca539225"> </div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-ee988aeed1944d1ab948ea928b1fe034" data-id="ee988aeed1944d1ab948ea928b1fe034"><span><div id="ee988aeed1944d1ab948ea928b1fe034" class="notion-header-anchor"></div><a class="notion-hash-link" href="#ee988aeed1944d1ab948ea928b1fe034" title="跨架构（编译？开发？）使用 Fedora CoreOS"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">跨架构（编译？开发？）使用 Fedora CoreOS</span></span></h2><div class="notion-text notion-block-3be830a5b684496586106ed1f1a0179f">&lt;等待更新&gt;</div><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-b53d49f75d3e40b4aa8a74b035a6d512" data-id="b53d49f75d3e40b4aa8a74b035a6d512"><span><div id="b53d49f75d3e40b4aa8a74b035a6d512" class="notion-header-anchor"></div><a class="notion-hash-link" href="#b53d49f75d3e40b4aa8a74b035a6d512" title="疑问"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">疑问</span></span></h2><ol start="1" class="notion-list notion-list-numbered notion-block-ea52fec955c3480da8aa8589296e6829"><li>正在使用的 Fedora CoreOS 是没有办法修改配置文件的吗？</li><ol class="notion-list notion-list-numbered notion-block-ea52fec955c3480da8aa8589296e6829"><div class="notion-text notion-block-74a1ec46e9ca47668e34be1427bb40b9">Fedora CoreOS 仅允许在第一次启动的时候使用 Ignotion 配置文件来配置系统。如果需要修改 Ignotion，那么只能够重新创建一个实例来重新下发配置。如果是学习用途需要重复地修改的话，可能使用远程配置文件来间接修改会方便一点？</div></ol></ol><h2 class="notion-h notion-h1 notion-h-indent-0 notion-block-1c0aa5b8dbb34781beb4e632f507a04a" data-id="1c0aa5b8dbb34781beb4e632f507a04a"><span><div id="1c0aa5b8dbb34781beb4e632f507a04a" class="notion-header-anchor"></div><a class="notion-hash-link" href="#1c0aa5b8dbb34781beb4e632f507a04a" title="参考资料"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">参考资料</span></span></h2><div class="notion-row"><a target="_blank" rel="noopener noreferrer" class="notion-bookmark notion-block-c71ea0ed67f846a8bee0749948a0c86f" href="https://vuepress.mirror.docker-practice.com/coreos/intro/#"><div><div class="notion-bookmark-title">Fedora CoreOS 介绍</div><div class="notion-bookmark-link"><div class="notion-bookmark-link-text">https://vuepress.mirror.docker-practice.com/coreos/intro/#</div></div></div></a></div><div class="notion-row"><a target="_blank" rel="noopener noreferrer" class="notion-bookmark notion-block-ad830dd2c6054160a9241621185f4b56" href="https://docs.fedoraproject.org/en-US/fedora-coreos/producing-ign/"><div><div class="notion-bookmark-title">Producing an Ignition Config</div><div class="notion-bookmark-description">Learn more about Fedora Linux, the Fedora Project &amp; the Fedora Community.</div><div class="notion-bookmark-link"><div class="notion-bookmark-link-icon"><img src="https://www.notion.so/image/https%3A%2F%2Fdocs.fedoraproject.org%2Ffavicon.ico?table=block&amp;id=ad830dd2-c605-4160-a924-1621185f4b56&amp;t=ad830dd2-c605-4160-a924-1621185f4b56" alt="Producing an Ignition Config" loading="lazy" decoding="async"/></div><div class="notion-bookmark-link-text">https://docs.fedoraproject.org/en-US/fedora-coreos/producing-ign/</div></div></div><div class="notion-bookmark-image"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Fdocs.fedoraproject.org%2Fen-US%2F_%2Fimg%2Fdocs_logo.png?table=block&amp;id=ad830dd2-c605-4160-a924-1621185f4b56&amp;t=ad830dd2-c605-4160-a924-1621185f4b56" alt="Producing an Ignition Config" loading="lazy" decoding="async"/></div></a></div><div class="notion-row"><a target="_blank" rel="noopener noreferrer" class="notion-bookmark notion-block-a3669da65a8a4279bf86aaaa9f4157d5" href="https://mogeko.me/posts/zh-cn/103/"><div><div class="notion-bookmark-title">从零开始打造你的专属 NAS</div><div class="notion-bookmark-description">既然大家都是方案的整合商，那为何不自己掌握自己的命运，自己来当这个整合商呢？</div><div class="notion-bookmark-link"><div class="notion-bookmark-link-icon"><img src="https://www.notion.so/image/https%3A%2F%2Fmogeko.me%2Ffavicon%2Fandroid-icon-192x192.png?table=block&amp;id=a3669da6-5a8a-4279-bf86-aaaa9f4157d5&amp;t=a3669da6-5a8a-4279-bf86-aaaa9f4157d5" alt="从零开始打造你的专属 NAS" loading="lazy" decoding="async"/></div><div class="notion-bookmark-link-text">https://mogeko.me/posts/zh-cn/103/</div></div></div></a></div><div class="notion-row"><a target="_blank" rel="noopener noreferrer" class="notion-bookmark notion-block-be9e9a6ced6c4d73a8b1ea90277e32e2" href="https://www.itix.fr/fr/blog/build-your-own-distribution-on-fedora-coreos/"><div><div class="notion-bookmark-title">Build your own distribution based on Fedora CoreOS</div><div class="notion-bookmark-description">Fedora CoreOS is a new Linux distribution from the Fedora Project that features filesystem immutability (you cannot change the system while it is running) and atomic upgrades (you cannot break your system if there is a crash or power loss during the upgrade). Upon installation, Fedora CoreOS (FCOS) can be tailored to your needs using Ignition files. Once installed, you can install RPMs, tweak configuration files, etc. This article tries to explore Fedora CoreOS customizability one step further by building your own distribution based on Fedora CoreOS. The idea would be to have everything wired in the Operating System image and minimal configuration in the Ignition file.</div><div class="notion-bookmark-link"><div class="notion-bookmark-link-text">https://www.itix.fr/fr/blog/build-your-own-distribution-on-fedora-coreos/</div></div></div></a></div></main></div>